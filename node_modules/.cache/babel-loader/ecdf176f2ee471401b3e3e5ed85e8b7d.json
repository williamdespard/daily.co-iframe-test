{"ast":null,"code":"var _jsxFileName = \"/Users/williamdespard/Desktop/Embryo/code/tests/daily.co-iframe-test/src/App.js\";\nimport React, { useState, useEffect } from \"react\";\nimport DailyIframe from \"@daily-co/daily-js\";\nimport \"./App.css\";\nimport Participant from \"./Participant\";\n\nfunction App() {\n  const [globalParticipantTracks, setGlobalParticipantTracks] = useState({});\n  const [localParticipantTracks, setLocalParticipantTracks] = useState({});\n  const [globalCallObject, setGlobalCallObject] = useState(null);\n  const [localCallObject, setLocalCallObject] = useState(null);\n  const [joinedLocal, setJoinedLocal] = useState(false); // initialize call objects after render\n\n  useEffect(() => {\n    const globalObj = DailyIframe.createFrame({\n      iframeStyle: {\n        position: \"fixed\",\n        top: 0,\n        left: 0,\n        width: \"0%\",\n        height: \"0%\"\n      }\n    });\n    const localObj = DailyIframe.createCallObject();\n    setGlobalCallObject(globalObj);\n    setLocalCallObject(localObj);\n  }, []); // join global channel after initialization\n\n  useEffect(() => {\n    (async () => {\n      if (globalCallObject) {\n        await globalCallObject.join({\n          url: \"https://example-embryo.daily.co/global\",\n          // start_video_off: true, start_audio_off: false (NOT WORKING)\n          // eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ2byI6dHJ1ZSwiYW8iOmZhbHNlLCJkIjoiNmQxZWRlOGItZjc5NS00NmE0LWFlZTAtNjFjNzMzMDk1ODZjIiwiaWF0IjoxNTkzMTc4OTY2fQ.8_QjBhBoN0C22UImQAQ0268FTSCcCYSe1n4sqZupIAA\n          // start_video_off: true, start_audio_off: true (NOT WORKING)\n          // eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ2byI6dHJ1ZSwiYW8iOnRydWUsImQiOiI2ZDFlZGU4Yi1mNzk1LTQ2YTQtYWVlMC02MWM3MzMwOTU4NmMiLCJpYXQiOjE1OTMxNzkwNzZ9.BLkEMtrpT88V83Hgl6dZ-vGpEI5fWDRaTqKFOQIQrQc\n          // start_video_off: false, start_audio_off: true (NOT WORKING)\n          // eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ2byI6ZmFsc2UsImFvIjp0cnVlLCJkIjoiNmQxZWRlOGItZjc5NS00NmE0LWFlZTAtNjFjNzMzMDk1ODZjIiwiaWF0IjoxNTkzMTc5MzI2fQ.RPkPfdEJpvOP4OjukA5Guo0aCObSlZ8jzOzus8T63pc\n          token: \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ2byI6ZmFsc2UsImFvIjp0cnVlLCJkIjoiNmQxZWRlOGItZjc5NS00NmE0LWFlZTAtNjFjNzMzMDk1ODZjIiwiaWF0IjoxNTkzMTc5MzI2fQ.RPkPfdEJpvOP4OjukA5Guo0aCObSlZ8jzOzus8T63pc\"\n        });\n      }\n    })();\n\n    return () => {\n      if (globalCallObject) {\n        globalCallObject.leave();\n      }\n    };\n  }, [globalCallObject]); // store media objects for global\n\n  useEffect(() => {\n    if (!globalCallObject) return;\n    const cleanUpEvents = handleParticipantEvents(globalCallObject, setGlobalParticipantTracks);\n    return () => {\n      cleanUpEvents();\n    };\n  }, [globalCallObject]); // store media objects for local\n\n  useEffect(() => {\n    if (!localCallObject) return;\n    const cleanUpEvents = handleParticipantEvents(localCallObject, setLocalParticipantTracks);\n    return () => {\n      cleanUpEvents();\n    };\n  }, [localCallObject]); // function to handle participant updates\n\n  function handleParticipantEvents(callObject, setParticipants, note) {\n    const participantEvents = [\"participant-joined\", \"participant-updated\", \"participant-left\"];\n\n    function handleNewParticipantState(event) {\n      setParticipants({ ...callObject.participants()\n      });\n    } // set function for events\n\n\n    for (const event of participantEvents) {\n      callObject.on(event, handleNewParticipantState);\n    } // return a function to unregister the events\n\n\n    return () => {\n      for (const event of participantEvents) {\n        callObject.off(event, handleNewParticipantState);\n      }\n    };\n  } // function to join to the local room\n\n\n  async function handleLocalClick() {\n    if (joinedLocal) {\n      await localCallObject.leave();\n      await globalCallObject.join();\n      setJoinedLocal(false);\n    } // leave the global\n    else {\n        globalCallObject.leave();\n\n        if (localCallObject) {\n          await localCallObject.join({\n            url: \"https://example-embryo.daily.co/local\"\n          });\n        }\n\n        setJoinedLocal(true);\n      }\n  }\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"App\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"header\", {\n    className: \"App-header\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 7\n    }\n  }, \"Global channel is by default, you can open/close local channel, When local is closed you will hear audio from global\", /*#__PURE__*/React.createElement(\"button\", {\n    onClick: handleLocalClick,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 9\n    }\n  }, \"Click to \", joinedLocal ? \"leave\" : \"join\", \" local\")), Object.entries(localParticipantTracks).map(([key, localParticipant]) => {\n    console.log(\"This is local\", localParticipant);\n    return /*#__PURE__*/React.createElement(Participant, {\n      key: localParticipant.user_id,\n      videoTrack: localParticipant.videoTrack,\n      audioTrack: localParticipant.audioTrack,\n      isLocal: localParticipant.local,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 145,\n        columnNumber: 11\n      }\n    });\n  }), /*#__PURE__*/React.createElement(\"iframe\", {\n    id: \"global-call-iframe\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 153,\n      columnNumber: 7\n    }\n  }));\n}\n\nexport default App;","map":{"version":3,"sources":["/Users/williamdespard/Desktop/Embryo/code/tests/daily.co-iframe-test/src/App.js"],"names":["React","useState","useEffect","DailyIframe","Participant","App","globalParticipantTracks","setGlobalParticipantTracks","localParticipantTracks","setLocalParticipantTracks","globalCallObject","setGlobalCallObject","localCallObject","setLocalCallObject","joinedLocal","setJoinedLocal","globalObj","createFrame","iframeStyle","position","top","left","width","height","localObj","createCallObject","join","url","token","leave","cleanUpEvents","handleParticipantEvents","callObject","setParticipants","note","participantEvents","handleNewParticipantState","event","participants","on","off","handleLocalClick","Object","entries","map","key","localParticipant","console","log","user_id","videoTrack","audioTrack","local"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport DailyIframe from \"@daily-co/daily-js\";\nimport \"./App.css\";\nimport Participant from \"./Participant\";\n\nfunction App() {\n  const [globalParticipantTracks, setGlobalParticipantTracks] = useState({});\n  const [localParticipantTracks, setLocalParticipantTracks] = useState({});\n  const [globalCallObject, setGlobalCallObject] = useState(null);\n  const [localCallObject, setLocalCallObject] = useState(null);\n  const [joinedLocal, setJoinedLocal] = useState(false);\n\n  // initialize call objects after render\n  useEffect(() => {\n    const globalObj = DailyIframe.createFrame({\n      iframeStyle: {\n        position: \"fixed\",\n        top: 0,\n        left: 0,\n        width: \"0%\",\n        height: \"0%\"\n      }\n    });\n    const localObj = DailyIframe.createCallObject();\n\n    setGlobalCallObject(globalObj);\n    setLocalCallObject(localObj);\n  }, []);\n\n  // join global channel after initialization\n  useEffect(\n    () => {\n      (async () => {\n        if (globalCallObject) {\n          await globalCallObject.join({\n            url: \"https://example-embryo.daily.co/global\",\n\n            // start_video_off: true, start_audio_off: false (NOT WORKING)\n            // eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ2byI6dHJ1ZSwiYW8iOmZhbHNlLCJkIjoiNmQxZWRlOGItZjc5NS00NmE0LWFlZTAtNjFjNzMzMDk1ODZjIiwiaWF0IjoxNTkzMTc4OTY2fQ.8_QjBhBoN0C22UImQAQ0268FTSCcCYSe1n4sqZupIAA\n\n            // start_video_off: true, start_audio_off: true (NOT WORKING)\n            // eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ2byI6dHJ1ZSwiYW8iOnRydWUsImQiOiI2ZDFlZGU4Yi1mNzk1LTQ2YTQtYWVlMC02MWM3MzMwOTU4NmMiLCJpYXQiOjE1OTMxNzkwNzZ9.BLkEMtrpT88V83Hgl6dZ-vGpEI5fWDRaTqKFOQIQrQc\n\n            // start_video_off: false, start_audio_off: true (NOT WORKING)\n            // eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ2byI6ZmFsc2UsImFvIjp0cnVlLCJkIjoiNmQxZWRlOGItZjc5NS00NmE0LWFlZTAtNjFjNzMzMDk1ODZjIiwiaWF0IjoxNTkzMTc5MzI2fQ.RPkPfdEJpvOP4OjukA5Guo0aCObSlZ8jzOzus8T63pc\n\n            token:\n              \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ2byI6ZmFsc2UsImFvIjp0cnVlLCJkIjoiNmQxZWRlOGItZjc5NS00NmE0LWFlZTAtNjFjNzMzMDk1ODZjIiwiaWF0IjoxNTkzMTc5MzI2fQ.RPkPfdEJpvOP4OjukA5Guo0aCObSlZ8jzOzus8T63pc\"\n          });\n        }\n      })();\n      return () => {\n        if (globalCallObject) {\n          globalCallObject.leave();\n        }\n      };\n    },\n    [globalCallObject]\n  );\n\n  // store media objects for global\n  useEffect(\n    () => {\n      if (!globalCallObject) return;\n      const cleanUpEvents = handleParticipantEvents(\n        globalCallObject,\n        setGlobalParticipantTracks\n      );\n      return () => {\n        cleanUpEvents();\n      };\n    },\n    [globalCallObject]\n  );\n\n  // store media objects for local\n  useEffect(\n    () => {\n      if (!localCallObject) return;\n      const cleanUpEvents = handleParticipantEvents(\n        localCallObject,\n        setLocalParticipantTracks\n      );\n      return () => {\n        cleanUpEvents();\n      };\n    },\n    [localCallObject]\n  );\n\n  // function to handle participant updates\n  function handleParticipantEvents(callObject, setParticipants, note) {\n    const participantEvents = [\n      \"participant-joined\",\n      \"participant-updated\",\n      \"participant-left\"\n    ];\n    function handleNewParticipantState(event) {\n      setParticipants({ ...callObject.participants() });\n    }\n\n    // set function for events\n    for (const event of participantEvents) {\n      callObject.on(event, handleNewParticipantState);\n    }\n\n    // return a function to unregister the events\n    return () => {\n      for (const event of participantEvents) {\n        callObject.off(event, handleNewParticipantState);\n      }\n    };\n  }\n  // function to join to the local room\n  async function handleLocalClick() {\n    if (joinedLocal) {\n      await localCallObject.leave();\n      await globalCallObject.join();\n      setJoinedLocal(false);\n    }\n    // leave the global\n    else {\n      globalCallObject.leave();\n      if (localCallObject) {\n        await localCallObject.join({\n          url: \"https://example-embryo.daily.co/local\"\n        });\n      }\n      setJoinedLocal(true);\n    }\n  }\n\n  return (\n    <div className=\"App\">\n      <header className=\"App-header\">\n        Global channel is by default, you can open/close local channel, When\n        local is closed you will hear audio from global\n        <button onClick={handleLocalClick}>\n          Click to {joinedLocal ? \"leave\" : \"join\"} local\n        </button>\n      </header>\n      {Object.entries(localParticipantTracks).map(([key, localParticipant]) => {\n        console.log(\"This is local\", localParticipant);\n        return (\n          <Participant\n            key={localParticipant.user_id}\n            videoTrack={localParticipant.videoTrack}\n            audioTrack={localParticipant.audioTrack}\n            isLocal={localParticipant.local}\n          />\n        );\n      })}\n      <iframe id=\"global-call-iframe\" />\n    </div>\n  );\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}